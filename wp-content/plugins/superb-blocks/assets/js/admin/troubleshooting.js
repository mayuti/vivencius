(()=>{"use strict";const e=jQuery("#tmpl-superb-addons-troubleshooting-step").text(),s={States:{Success:"success",Error:"error"},CurrentStep:-1,SuccessfulSteps:0,Resolves:0,AvailableSteps:[{id:"spbaddons-process-step-wordpress-version-check",title:superbaddonstroubleshooting_g.steps.wordpressversion.title,text:superbaddonstroubleshooting_g.steps.wordpressversion.text,errorText:superbaddonstroubleshooting_g.steps.wordpressversion.errorText,successText:superbaddonstroubleshooting_g.steps.wordpressversion.successText,route:"wordpressversion",terminates:!1,resolver:!1},{id:"spbaddons-process-step-elementor-version-check",title:superbaddonstroubleshooting_g.steps.elementorversion.title,text:superbaddonstroubleshooting_g.steps.elementorversion.text,errorText:superbaddonstroubleshooting_g.steps.elementorversion.errorText,successText:superbaddonstroubleshooting_g.steps.elementorversion.successText,route:"elementorversion",terminates:!1,resolver:!1},{id:"spbaddons-process-step-api-connection-check",title:superbaddonstroubleshooting_g.steps.connection.title,text:superbaddonstroubleshooting_g.steps.connection.text,errorText:superbaddonstroubleshooting_g.steps.connection.errorText,successText:superbaddonstroubleshooting_g.steps.connection.successText,route:"connection",terminates:!1,resolver:{id:"spbaddons-process-step-api-domainshift",title:superbaddonstroubleshooting_g.steps.domainshift.title,text:superbaddonstroubleshooting_g.steps.domainshift.text,errorText:superbaddonstroubleshooting_g.steps.domainshift.errorText,successText:superbaddonstroubleshooting_g.steps.domainshift.successText,route:"domainshift",terminates:!0,resolver:!1}},{id:"spbaddons-process-step-api-service-check",title:superbaddonstroubleshooting_g.steps.service.title,text:superbaddonstroubleshooting_g.steps.service.text,errorText:superbaddonstroubleshooting_g.steps.service.errorText,successText:superbaddonstroubleshooting_g.steps.service.successText,route:"service",terminates:!0,resolver:!1},{id:"spbaddons-process-step-license-key-check",title:superbaddonstroubleshooting_g.steps.keycheck.title,text:superbaddonstroubleshooting_g.steps.keycheck.text,errorText:superbaddonstroubleshooting_g.steps.keycheck.errorText,successText:superbaddonstroubleshooting_g.steps.keycheck.successText,route:"keycheck",terminates:!1,resolver:{id:"spbaddons-process-step-api-key-verify",title:superbaddonstroubleshooting_g.steps.keyverify.title,text:superbaddonstroubleshooting_g.steps.keyverify.text,errorText:superbaddonstroubleshooting_g.steps.keyverify.errorText,successText:superbaddonstroubleshooting_g.steps.keyverify.successText,route:"keyverify",terminates:!0,resolver:!1}},{id:"spbaddons-process-step-cache-clear",title:superbaddonstroubleshooting_g.steps.cacheclear.title,text:superbaddonstroubleshooting_g.steps.cacheclear.text,errorText:superbaddonstroubleshooting_g.steps.cacheclear.errorText,successText:superbaddonstroubleshooting_g.steps.cacheclear.successText,route:"cacheclear",terminates:!1,resolver:!1,runOnlyOnZeroResolves:!0}],GetCurrentStep:function(){return this.AvailableSteps[this.CurrentStep]},GetNextStep:function(){return!(this.AvailableSteps.length<=this.CurrentStep)&&this.AvailableSteps[++this.CurrentStep]}},t=async function(e){let d=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return void u();if(e.runOnlyOnZeroResolves&&s.Resolves>0)return s.SuccessfulSteps++,void t(s.GetNextStep());o(e),await async function(e){return new Promise((e=>setTimeout(e,1e3)))}();const p=await i(e.route);let c=!1;if(p.success&&(c=!0),p.text&&(e.successText=p.text,e.errorText=p.text),n(e,c),!c){if(!1!==e.resolver&&!0!==p.ignoreResolver)return void t(e.resolver,!0);if(e.terminates)return void u()}c&&(d&&(s.Resolves++,r(s.GetCurrentStep())),s.SuccessfulSteps++),t(s.GetNextStep())},o=s=>{let t=jQuery(e);t.find(".spbaddons-troubleshooting-step-text").text(s.text+"..."),t.find(".spbaddons-troubleshooting-step-title").text(s.title),t.addClass(s.id),jQuery(".spbaddons-troubleshooting-steps").append(t)},r=e=>{const s="."+e.id;jQuery(s).css("opacity","0.5"),jQuery(s).addClass("spbaddons-troubleshooting-step-resolved")},n=(e,s)=>{const t="."+e.id;jQuery(t).find(".spbaddons-troubleshooting-step-spinner").hide(),s?(jQuery(t).find(".spbaddons-troubleshooting-step-checkmark").show(),jQuery(t).find(".spbaddons-troubleshooting-step-text").text(e.successText)):(jQuery(t).find(".spbaddons-troubleshooting-step-error").show(),jQuery(t).find(".spbaddons-troubleshooting-step-text").text(e.errorText))},i=async e=>{const s=await fetch(superbaddonstroubleshooting_g.rest.base+superbaddonstroubleshooting_g.rest.namespace+superbaddonstroubleshooting_g.rest.routes.troubleshooting,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8","X-WP-Nonce":superbaddonstroubleshooting_g.rest.nonce},body:"action="+e});return 200!==s.status?{success:!1,text:"Unknown error occured. Please contact support if the issue persists."}:s.json()},u=()=>s.Resolves>0&&s.AvailableSteps.length<=s.SuccessfulSteps?(jQuery(".spbaddons-troubleshooting-result-resolved").show(),void jQuery(".spbaddons-troubleshooting-result-wrapper").slideDown()):s.AvailableSteps.length<=s.SuccessfulSteps?(jQuery(".spbaddons-troubleshooting-result-success").show(),void jQuery(".spbaddons-troubleshooting-result-wrapper").slideDown()):(jQuery(".spbaddons-troubleshooting-result-error").show(),void jQuery(".spbaddons-troubleshooting-result-wrapper").slideDown());var d;(d=jQuery)("#spbaddons-troubleshooting-submit-btn").on("click",(function(){d(this).remove(),t(s.GetNextStep())}))})();